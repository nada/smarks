<head>
  <title>smarks!</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="http://scripts.embed.ly/jquery.embedly.min.js"></script>
  <link rel="icon" href="/favicon.png" type="image/png"/>
</head>

<body>
  {{> alltags}}
  {{> page}}
</body>

<template name="page">

  <div class="container-fluid page">

    <div class="row-fluid">
      <div class="loginButtons clearfix">{{loginButtons align="right"}}</div>
    </div>

    <div class="row-fluid smark-input-row">
      <div class="span1"></div>
      <div class="span5">
        {{#if currentUser}}
        <textarea id="new-smark" placeholder="smark me link / add tags with hashes!"></textarea>
        {{else}}
        Your are definitely not logged in at all!
        {{/if}}
      </div>
    </div>

    <div class="row-fluid">
      <div class="span1"></div>
      <div class="span10 timeline-header">
        {{> timeline_header}}
      </div>
    </div>
    
    <div class="row-fluid">
      <div class="span1"></div>
      <div class="span10 timeline">
        {{> timeline }}
      </div>
    </div>

    <div class="footer-row">
      <span><a href="http://flashpogo.com" target="_blank">smarks!</a> /<em>(0.6.1)</em></span>
      <span><a href="https://github.com/nada/smarks" target="_blank">your own smarks? <i class="icon-github"></i></a></span>
    </div>
  </div>

  <div class="beta-ribbon">
    <span class="vert-flag">beta</span>
  </div>

  {{#if showNews}}
  <div class="alert alert-info" style="position:absolute;top:30px;width:50%;left:25%;">
    <button type="button" class="close" data-dismiss="alert">Ã—</button>
      <br/><h4>smarks! updated</h4><br/>
      introducing some sort of tagging system. try it and give feedback to make it better!<br/><br/>
  </div>
  {{/if}}

</template>

<template name="timeline_header">
  {{#if currentUser}}
    {{#each tagFilters}}<button class="tagfilter btn btn-small" type="button"><i class="icon-remove"></i> {{this}}</button>{{/each}}
    <button class="fav-only btn btn-small" type="button"><i class="icon-heart"></i> only</button>
  {{/if}}
</template>

<template name="timeline">
    {{#each posts}}{{> post}}{{/each}}
</template>

<template name="post">
  <div class="box smark" data-id="{{_id}}">
   <div class="inner">
      <span class="title">{{firstEmbedlyTitle}}</span>
      <span class="smark">{{smark}}</span>
      {{#each embedly}}{{> embedly}}{{/each}}
    </div>
    {{#if currentUser}}
      <div class="info">
        <div class="info-more clearfix">
          <span class="avatar-time"><a href="#" class="avatar">{{ avatar }}</a>, {{ timeSince timestamp }}</span>
          <span class="remove">{{#if isOwner}}<i class="icon-remove"></i>{{/if}}</span>
        </div>
        {{#each tags}}<a href="#" class="tag">{{ this }}</a>{{/each}}
        <i class="icon-tags"></i>
        {{ totalhearts }}<i class="icon-heart"></i>
      </div>

      {{#if taggingThis}}
      <div id="taggingSystem">
        <a href="#" class="icon-remove"></a>
        <input id="new-tag" type="text" data-provide="typeahead" data-source='{{alltags}}' placeholder="add tags, comma-separated"/>
        {{#each tags}}<button class="tag-remove btn btn-mini" type="button" value="{{this}}"><i class="icon-remove"></i> {{this}}</button>{{/each}}
      </div>
      {{/if}}

    {{/if}}
  </div>
  
</template>

<template name="embedly">
  <div class="embedly"><a href="{{this.url}}" target="_blank"><img src="{{this.thumb.url}}" width="{{this.thumb.width}}" height="{{this.thumb.height}}"/></a></div>
</template>

<template name="alltags">
  <span class="alltags" data-alltags='{{alltags}}'></span>
</template>


